<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Genesis Admin Control Panel - Quantum Eye</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/components/admin-control-panel.css">
    <link rel="stylesheet" href="css/themes/dark.css">
    <link rel="stylesheet" href="css/themes/print.css">
    <script>
        // Initialize session for testing
        sessionStorage.setItem('isAuthenticated', 'true');
        sessionStorage.setItem('userRole', 'genesis');
        sessionStorage.setItem('userName', 'genesis');
    </script>
</head>
<body class="page">
    <nav class="nav">
        <div class="nav__container">
            <button id="hamburger" class="nav__toggle">&#9776;</button>
            <span class="nav__brand">Quantum Eye</span>
            <div class="nav__menu">
                <span class="nav__link user-name" id="userName"></span>
            </div>
        </div>
        <div id="navMenu" class="nav__dropdown" hidden>
            <button class="nav__dropdown-item" id="logoutBtn">Logout</button>
            <button class="nav__dropdown-item" id="exitBtn">Exit</button>
        </div>
    </nav>

    <div id="sidebar" class="sidebar">
        <a href="javascript:void(0)" class="sidebar__close" id="close-sidebar">&times;</a>
        <div class="sidebar__brand">Quantum Eye</div>
        <div id="menu-items">
            <!-- Menu items will be populated based on user role -->
        </div>
    </div>

    <div class="page__container">
        <div class="content-area l-container">
            <div class="admin-control-panel">
                <h1 class="page-title">Genesis Admin Control Panel</h1>
                
                <div class="section">
                    <h2 class="section-title">Create New Admin User</h2>
                    <p class="form-description">
                        Use this form to create new Platform Admins or User Admins. 
                        Each admin will need to change their password upon first login.
                    </p>
                    
                    <form id="admin-creation-form" class="user-form" method="post" onsubmit="return false;">
                        <div class="form-group">
                            <label for="username" class="required-field">Username</label>
                            <input 
                                type="text" 
                                id="username" 
                                name="username" 
                                autocomplete="username" 
                                required
                            >
                        </div>
                        
                        <div class="form-group">
                            <label for="email" class="required-field">Email</label>
                            <input 
                                type="email" 
                                id="email" 
                                name="email" 
                                autocomplete="email" 
                                required
                            >
                        </div>

                        <div class="form-group">
                            <label for="password" class="required-field">Initial Password</label>
                            <input 
                                type="password" 
                                id="password" 
                                name="password" 
                                autocomplete="new-password" 
                                required
                            >
                        </div>
                        
                        <div class="form-group">
                            <label for="role" class="required-field">Admin Type</label>
                            <select id="role" name="role" required>
                                <option value="">Select admin type</option>
                                <option value="user" selected>User Admin</option>
                                <option value="platform">Platform Admin</option>
                            </select>
                        </div>
                        
                        <button type="submit" id="submitBtn" class="button button--primary">Create Admin User</button>
                    </form>
                </div>

                <div class="section">
                    <h2 class="section-title">Existing Admin Users</h2>
                    <div id="admin-list-container">
                        <!-- Admin list will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Load scripts -->
    <script src="js/dataservice.js"></script>
    <script src="js/modules/navigation.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Set username from session
            const userName = sessionStorage.getItem('userName');
            if (userName) {
                document.getElementById('userName').textContent = userName;
            }

            // Setup hamburger menu
            const hamburger = document.getElementById('hamburger');
            const navMenu = document.getElementById('navMenu');
            
            hamburger.addEventListener('click', (e) => {
                e.stopPropagation();
                const isHidden = navMenu.hasAttribute('hidden');
                if (isHidden) {
                    navMenu.removeAttribute('hidden');
                } else {
                    navMenu.setAttribute('hidden', '');
                }
                navigation.toggleNav();
            });

            // Setup logout and exit buttons
            document.getElementById('logoutBtn').addEventListener('click', () => {
                navigation.logout();
            });

            document.getElementById('exitBtn').addEventListener('click', () => {
                navigation.exitApplication();
            });

            // Close menu when clicking outside
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.nav__dropdown') && !e.target.closest('.nav__toggle')) {
                    navMenu.setAttribute('hidden', '');
                }
            });

            // Initialize sidebar menu based on user role
            const userRole = sessionStorage.getItem('userRole');
            const menuItems = document.getElementById('menu-items');
            
            if (userRole === 'genesis') {
                menuItems.innerHTML = `
                    <a href="adminControlPanel.html" class="sidebar__link">Admin Control Panel</a>
                    <a href="userProfile.html" class="sidebar__link">My Profile</a>
                    <a href="settings.html" class="sidebar__link">Settings</a>
                `;
            }

            // Setup sidebar close button
            const closeBtn = document.getElementById('close-sidebar');
            closeBtn.addEventListener('click', () => {
                const sidebar = document.getElementById('sidebar');
                sidebar.style.width = '0';
                sidebar.classList.remove('sidebar--open');
            });

            // Close sidebar when clicking outside
            document.addEventListener('click', (event) => {
                const sidebar = document.getElementById('sidebar');
                if (!event.target.closest('#sidebar') && 
                    !event.target.closest('#hamburger') && 
                    sidebar.classList.contains('sidebar--open')) {
                    sidebar.style.width = '0';
                    sidebar.classList.remove('sidebar--open');
                }
            });

            // Close sidebar when pressing Escape
            document.addEventListener('keydown', (e) => {
                const sidebar = document.getElementById('sidebar');
                if (e.key === 'Escape' && sidebar.classList.contains('sidebar--open')) {
                    sidebar.style.width = '0';
                    sidebar.classList.remove('sidebar--open');
                }
            });
        });
    </script>
    <script src="js/admincontrolpanel.js"></script>
</body>
</html>
